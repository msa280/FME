#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN AggregatorTransposer,1,"Filters and Joins",bdaaf448-3122-43f1-8d23-353898eb3052,"Linked Always",No,NO_PARALLELISM,,No,22343,YES,No,39,No,
# <p><strong>Transposes attributes so that the values in any selected Column Attribute are transposed into their own individual columns. The corresponding selected Row Attribute(s) will also be transposed in accordance with the selected column and its attributes. Aggregation works by grouping the results into desired Group-By column categories. This transformer also allows you to add a suffix to the end of the newly transposed column names in order to maintain clarity and produce distinction between previously defined data columns.</strong></p>
# <h3 id="example">(Example):</h3>
# <p><strong>The table below shows the inputs offered by the transformer:</strong></p>
# <p><img alt="Inputs" src="https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Transformer%20Inputs.PNG" /></p>
# <p><strong>The data structure below shows the data before it is transposed. </strong></p>
# <p><img alt="Data" src="https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Data%20before%20transformer%20processing.PNG" /></p>
# <p><strong>The next image shows the state of data after it has gone through the transformer using the inputs specified in Image 1. This displays the tranposing + aggregation behavior of the transformer.
# </strong></p>
# <p><img alt="TransformerBehavior" src="https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Data%20after%20transformer%20processing.PNG" /></p>
# <h3 id="notes"><em>Notes</em></h3>
# <ul>
# <li>The transformer will not preserve geometry. It only works on tabular data. </li>
# <li>New attributes are created dynamically and should be exposed using an <a href="https://www.safe.com/transformers/attribute-exposer/">AttributeExposer</a>, for example. </li>
# <li>All original attributes will still be exposed on the output feature, but will not have a value, except for the Column Attributes. </li>
# <li>This transformer has been tested on Python 2.7 and 3.4. </li>
# </ul>
# TRANSFORMER_END
#!   A0_PREVIEW_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAC9CAIAAAASmLzHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAATbUlEQVR4nO3baVRUZ57H8f+tnX2HQkCFIEKQxK1jtJXQOi4x6tGMMRrFbE4MQZOTxWR6zsRMtMccY7edVtNRk45JEPu4JHFcEo1WG6OiRFAjIAooyFosVRS173deFJvIUmDZ9JPz+7zwcG/Vfe5Tl6ovdW+VHM/zBADAAsFgTwAAwF0IFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADADwQIAZiBYAMAMBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADADwQIAZiBYAMAMBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADADwQIAZiBYAMAMBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADADwQIAZiBYAMAMBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGaIBnsC/aM3GnIu51bVVUWGD/nt2AkBvv6DPSMA9hSVXbtUeJUTcONGPZwUlzjY0+kHjuf5wZ6Du749eSiv7OKQ+GD/IB+d1lhT0pQc/dAzTywa7Hn9+jWp1J0XHQ6HUCj01OA8z/M8LxB0vNkPDQke8GgGk9lkNLYvOpxOocCTpxFOp0Mg6Hjs/v7+EjFLf/VrlLXbv/6bd7hgyLAQnufrbqusKsHKp16Uh0YM9tTcwkywvjl5qMJ8PSwysPNKjUp/4UixWeOUSWUe3JfT6RTc+SzP/vRjj4z8+/WbKisr2hfNFotUIuE4ziODE5FQKHQ4HJ3X3PvMo5LGvLv9WOc1UpHAYnfe47C9OHdsb9YHrw5gw+YW3d4rxs5rgnyEzQZHT/cfgEBvkcZo77zm5cc881Jf9tKqzi9GmVRqtlg8MrKLl5eX2WzyGcpNfvyhzut5ni86V7n+lfckYokHd3efsBEsnVG/cfeHI8dFt6+5fb1W3dQyPCm6vkodEy/38ZV6cHcSodjqsJmNVqPGIvEReftKBUJB+riX7nHYFq3+75cNHplhT7wlAqPVaTEZtE3V/qExYqlMIBAM7BWlrK8PDg6+eLmgwBTV5ab7EayWxhqH1WC3O30DQ70DQrnbp1YuX+zmtlarVaPRhIeH7zrX2GVi9yNYdQ1NWpVSKuJ4oTRIPrzx1pV3n595j8M+vvCZZ36f1nmNn9RfZ9He47A8z1stNlWNLjTaPywg9PSp/JTfxJbfqNOodHFJUcFhrVdUbFaHuULwypKV97i7fwI2LrqfuZgTPSKEiHIV18qv1xXkltbXNsi8BFfOFEfGhFSV1ZffqNO1GImIqhTHc7oZoT6nsL6fO9U3WL3FvjKnr6pOW3NRtXX7DrVabW/jTujb77zry68OHzn6x60fE1HD/jkZaXMUNb1vWl6UW96xlLumY5NcRRERETXs31nU3Za802lS3Q7wkYptzS1NdUSUm3/JrQdM5HQ6CwoKSkpKSkpKfjip+O6Hk1cu51vNBspdk5Emz8513UtRcKFcsV9x19aK7DR5xp8UREQ1OxVHdypy3dwt2W02IW/x9/WLjAjVNzcQkVaj7nOrqqqq4uLikpKSnPPni0rKsvfua6m/TUSUuyY713WgFFdyiIgachXX7zhciqLWuZUrMuUZmTsb3J0pEVFzQ83w6EixVOojEVpMxgeSx/VnayIinuddTwyr1brjb5+fPnNmwQuPWS22ipK6yjKlVm2gKsV/pixZvqGwdYOcwqt3jnA1p/CuUbth1FnsGlGAd6BFxem0RqFAcC3/lrZJ7eMtKLhw3WyylN+ovXCyUCwRNhmb+vsoBgUbp99V9VU6qWn9K18QkVDALc6c6hfgRUTh0f5VN5VEAoGQu3Gl8sFxsd5E1KhYN34fvZEesznrVMqUedNnTBlecubTc34xo2bGuLvHhmpNRJhcZWiQOXwseoevV8D01Fnn8vJLiwrlERF2u722tlYul/cygslkUqvVsbGxRCSSykYkj1K1tDSp64nmrdpYemqL/EBuenpm8bnb0beOHJy8Zl3tprW3iCg5fXxRVt7UZXH1CZqza3cfTp87N6s5LJ2I9N/PydhNk6fmUdO67zaV/jazOCvt0MK3kw58mDX5hfSzjbM+eXMaETXV3IwIDtI7vTmHzqxtovCu7486s9lsJ0+erKurk0qlRMRxnMlkSk5OJiKb1ZqQONJoMt5uqJDQiIUb1ynPfKCgELpReqBp7MKbr2f8uG5Z3Nrdh8fPWkbHdtOsZfNG/6hcWrNzU9pSWvba2MgQatq5KW0tLXuNLoc8+/FL4T1Pw2rR+/v5KRtVUonE38/HajX3dM9ffvnl4sWLMpmM4zi9Xp+QkODl5dXS0hKXlOxwOCqv3ZCFxBTRrNGVO89Vrq24kX62uXHhzt36MfPCAg5lpa2d/MI6+bTpcsX+bY3KhV+9eYBem0VERKV/kr93OH3u3KzDh4mIJr+QfvbzrLg5r42dEkI3Sg98fscRloqFLTqdzmAZNiRMbTQS+fVyhF2am5tPnz6t1WqJiOf5+vp6Hx+foKAgp9OZkPRgWEREzqFc+URvo85it9sih4ZdPUavFfzdsCtr1x56fjj9349b1Y2LDq7fVzZjytI5yyLpaP6rzZQ36qE+96vUhwaFiAJ5R4tIVaclAWnV+uBQbyIKCPH/n//43HU3u80RHBrQ56P4V8BGsMKDI0ikf+fPy34+dS1UHmAx23kJL5aIVEpd8iMj66vUHM/HJQ3x9pVSMxHRhC3rI6mk7o31b9H5khPvrqFF70yPqu7XHqMDm6tbvKS+/n5+RpveWG348R+KGVN/N3fG9AHM/9NdXxRcyi8pqxiaNs1Ih7adfX1VeFYREdG82VNKtx0hIhq7MXtsZZyc/nqhiCbPzJSfPUFENHfWsKEjxg8lefamlJw5x5LnTZ+ZdKL1b+G8VdkP0C/HiNJHjxwhnzbNtTYkKs7YVCES23x9fAyBvZ0M6nS6HTt2LFmy5PHHH7/7VrvDqWmojwgL11IC1X1x4KsR73+8uCDzr/KPZz22uYHSst8fSqVn75jJtjQ5TV0Wd8cw48eOCaGU3mpFRN6+QQ2VxZHhYSaz2WCyB0lk3V68USgUPM+vWLGiy3q1Wn367LnpU39XJUq03N6uPFuqpBHypHQKmTXtQiOlvT6Rbpa1Hh26tHQiZW6eTDwRxaVN9qVH3qdjJ4pbD/WqTKJJpFSUEhENG6Z85/LojdTlCAulvjarLTZaXlldHTYsmXf2dnasVCr37t0bExOTlpYWHNz1wwSn07krK9vQrA6I8xKJRXEPRhl0JrFEGEF5r6Tso5RFL47YunzzlLe2TFE30oQt6ydUXKx9dWX2k6vferK51yPaKkjuy9kEFrVTJCR5TFC1slbmJbXZHGKx0KQzvb7x6brbqupbDZNmpFRcbXRnwEHHxjUslUa95duP4h+Kdjp5gYDjnXzhxZtmo3lIbLhZbwkbEuwf7HPXRoW7xm+lLTuen9Tv3bmuYemajSatTSgl30BvqUw8b+TiAX+Lgud5juOKS8tP13oPbAQ3ua5h6TUqvbrGOyhS5uMnkcjSHwnw8ermQ4lt27atXLlSLBb3Pub2020n0zU7s3OmL30q9j5ddDdq1UKxVOrlQ91dyTaZTHv37n3uued6GeHBCY+9+uG+zmvu00V3m9ViNrT4BYUT0VcbVuQcP9ztndVqdVZW1urVqwV9fVLZ9zWsKsW6BXkTvn3H/bMEInI6nEadRa3UB4Z7R8kjT/8jb/Sj8UX5N00GS1RseFRsuOsF5XTyqmLrG8tX92PoQcJGsIjoi4O7Tf4q3wCvzivNRmv5NeUjv03mOI99yk5EHHE8dRyWxlqNuUq46oUX733k1NkLXnn/s/bF+rpqQdsnhHaHTSTsox09cdrtApGIiEQCzicgWCJtPUrKqpuPJQSMGTXy7k0KCwvr6+untb1r6N2W7Z3mrNZeKy4UCYRExHM8xw/wI07eSZyAiMjJ81KJ9NHxY9pvevXlru+hiGjPnj1PPPFEQEAfZy5nL169lP9z++JP53Nd87PZ7OKBfv+A53m70yEWilw/p056tP2m+fPmDR3S49vHjz76KDMzs88/CS6zFy9Z+e6C9kWpSGqxe/JTQpnIS93SfDmvKGXCA11uuv5z9dvpbzHxrUZmgkVEO/fvqjNXDkuUCwWc08lXliiDOHnG0ys8+J2gf6aopDGf7T/VvigTC8y2Ab5t8ZUK9JaObUcFW2KG9HYyqNfrd+zY8eabb/Z3R8mPpv3xs4OuN4xE5CsV6i0DfP/iJRGYrB1zvl1W/PL8iT3duaysLC8vb/Fidz83dPm+UNM+VY4jTz3TTQbd3LHy3jNks9m+/PLL1NTUhIQEz+zVQ365UbD3xP6hySE+/l5EpNMaa65pls58+sH4pMGemltYChYRlVdX/JSXozfpvKXeE8dMSIz913o2uK+g+Hq1Q97UqLSZLZExw8hzwXI47NfPfJ02cfz4cd18eqXVao8dO9bY2LhixQrXhfZ+OVncYnPwPx4/NPo3kwKDQz0YrMr8ozIRNzwmemhMDMdxPM/LZDKNRlNbW1tWVhYcHPzUU0/1a/z/WvfBlCczLuWeCQwJjYtP8mCwbl35KdyfE3OUlJDgOoZisVgkEmk0Go1GU1NT47q4Pn/+/MDAwL4GGwRWu+3YTydqG2s5jouOiJ41+d8Y+pPPxkX3drHRw2Ojhw/2LDzAYXcQR0ajoaG2ukWjSkxRbU5cdOThDRtejreTsmh7Fj25QGuI//dYqiVl0fasgA0/zB/q1si80zlu7MMSX/+Ptm4L8vcTCASVlZVRUVGuNxpeXl4zZsy4xxeSSCysuFkyOli7b9G4bVeeW/fJbCJSlW863pye2qyPnhbfukjbN6fH9TVYKy+ZdMyY0Zfz8tQqVUhISEtLi8FgiI+PT0hImDp16oC/WyuRyRpqqiLkUb5X3pud8UXi21ueiZVTQ9meb1QzZ6pMsbOjiaihbM839NbujCFuDirgUlIeullaeubcuYT4eCIqKSkZNmxYYGBgUFBQYmJin+etg0siEs+bOnuwZzFAjAXrV0YoEHj7+CYkjyZq+1pT+aa1xxdsmLmg3lASQPEF5Zv+cnzBhpkL7O7VioiI48pv3tQ0NT6/PN3f379tnce+TE9EQ2Li4kYkEd1qW/Hd2gxad3RBap6+Koiii75bu43WHV2QWulurYio2eBoqKle/kz/Tvp6ERwSSkQBAUEjkx4WSzq+w30+YxF9kp8685zpVgjFXj6f8QF9kp8686a7tSKSeAUcPXJ01Usvtr9FTU1N9dS0oXeMnRL+mvzlwJmExJT2xS6nhLVnP/m6PH51ulvfouhyDWvDmufOfH/Qg1NtZ7ZYT5V2/N+XrqeElScO7iqLfi9jvBtDdTkl/MOa5899/60Hp0pEz67538XPZrp+vuuU8FZe1tbq2D/Pn9zvYT/471U/HdztkRlCfyFYg2n3vq/bf7ZZbGLpAD8ltNvtIlHrm+XJkyYNj470wOR63JfDbm//z3Q80UA/JWy7HE5ExJGs/xfU3GE2W7rZXf913lwmuy9TBXcgWADADDb+LyEAACFYAMAQBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADADwQIAZiBYAMAMBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADADwQIAZiBYAMAMBAsAmIFgAQAzECwAYAaCBQDMQLAAgBkIFgAwA8ECAGYgWADADAQLAJiBYAEAMxAsAGAGggUAzECwAIAZCBYAMAPBAgBmIFgAwAwECwCYgWABADMQLABgBoIFAMxAsACAGQgWADBDxPM8ERHHcTzPc0Q8xxHxRK3/UNvSHT93Xkkctd2b4zi+87bdcO2n8yLxPHHk2nfnO3Y3SJf9ckSt2/Y8Zw9ty5Frnq4bW49Tx4pednfngBxxPHV3nLvlunfbIK3bcsRTz8eq035d23Kug8uR67EOYM5uPd5uJ9M2j9Z59/N3xHHE08C2bVvs9sh0uy/Xr9f1y2k7zHf+wt0Ys2PmnZ/kvU60Y6mnrTqvd82qr4Fdr6qehiLq9ItsH7TjVdxppI77dzO99qNBd06KI6K25x61PwO7OVZ9HMi7V3FE/P8DSWZZPxv7JUkAAAAASUVORK5CYII="
#!   ARCGIS_COMPATIBILITY="ARCGIS_AUTO"
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Filters and Joins"
#!   DESCRIPTION="&lt;p&gt;&lt;strong&gt;Transposes attributes so that the values in any selected Column Attribute are transposed into their own individual columns. The corresponding selected Row Attribute(s) will also be transposed in accordance with the selected column and its attributes. Aggregation works by grouping the results into desired Group-By column categories. This transformer also allows you to add a suffix to the end of the newly transposed column names in order to maintain clarity and produce distinction between previously defined data columns.&lt;/strong&gt;&lt;/p&gt;&#10;&lt;h3 id=&quot;example&quot;&gt;(Example):&lt;/h3&gt;&#10;&lt;p&gt;&lt;strong&gt;The table below shows the inputs offered by the transformer:&lt;/strong&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;img alt=&quot;Inputs&quot; src=&quot;https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Transformer%20Inputs.PNG&quot; /&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;strong&gt;The data structure below shows the data before it is transposed. &lt;/strong&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;img alt=&quot;Data&quot; src=&quot;https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Data%20before%20transformer%20processing.PNG&quot; /&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;strong&gt;The next image shows the state of data after it has gone through the transformer using the inputs specified in Image 1. This displays the tranposing + aggregation behavior of the transformer.&#10;&lt;/strong&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;img alt=&quot;TransformerBehavior&quot; src=&quot;https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Data%20after%20transformer%20processing.PNG&quot; /&gt;&lt;/p&gt;&#10;&lt;h3 id=&quot;notes&quot;&gt;&lt;em&gt;Notes&lt;/em&gt;&lt;/h3&gt;&#10;&lt;ul&gt;&#10;&lt;li&gt;The transformer will not preserve geometry. It only works on tabular data. &lt;/li&gt;&#10;&lt;li&gt;New attributes are created dynamically and should be exposed using an &lt;a href=&quot;https://www.safe.com/transformers/attribute-exposer/&quot;&gt;AttributeExposer&lt;/a&gt;, for example. &lt;/li&gt;&#10;&lt;li&gt;All original attributes will still be exposed on the output feature, but will not have a value, except for the Column Attributes. &lt;/li&gt;&#10;&lt;li&gt;This transformer has been tested on Python 2.7 and 3.4. &lt;/li&gt;&#10;&lt;/ul&gt;"
#!   DOC_EXTENTS="3043.04 74.9557"
#!   DOC_TOP_LEFT="-1367.66 -935.964"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="22343"
#!   FME_DOCUMENT_GUID="bdaaf448-3122-43f1-8d23-353898eb3052"
#!   FME_DOCUMENT_PRIORGUID="0d30bee6-bbe1-11e7-8506-c42c033923d4,6300b6cc-bc14-11e7-bd75-c42c033923d4,05cfcadc-bc15-11e7-aca3-c42c033923d4,0f05df90-bc17-11e7-9f40-c42c033923d4,7b9c6c18-bc18-11e7-b498-c42c033923d4,9fe6de7c-bc1e-11e7-88e1-c42c033923d4,640331a6-bc20-11e7-8526-c42c033923d4,3c41b7d6-bc21-11e7-8f91-c42c033923d4,cddca654-bcaf-11e7-bf0c-c42c033923d4,3ba9387c-bcb1-11e7-acb3-c42c033923d4,bfec376a-bcb1-11e7-aa63-c42c033923d4,fb772514-bcb2-11e7-90db-c42c033923d4,10060934-bced-11e7-ad82-c42c033923d4,a36c8dd4-bdbe-11e7-8bc0-c42c033923d4,fdbd9902-bdc0-11e7-8e6c-c42c033923d4,b47909c4-c0dc-11e7-a942-c42c033923d4,d55afcb4-c204-11e7-aa0d-c42c033923d4,a4abeac2-c206-11e7-b288-c42c033923d4,0eb09ec2-c207-11e7-aa28-c42c033923d4,492901ac-c2f2-11e7-882e-c42c033923d4,bdab370a-c330-11e7-9b17-c42c033923d4,6e91ee51-5ce9-476a-9341-0547411075ee,dfcd8584-5530-4609-b82e-7dda2387be01,96f25355-e3e8-4eea-9723-97533e767963,4b35414f-8f37-44ba-bc72-b62fb021db19,2ac5b484-d98a-4812-a552-0b5c4cb8cdd5,55e43da0-b26b-49b8-984d-d36064e87a3c,ac097996-70f5-4945-aba3-53fb09319156,867d001d-9217-44fd-bc7d-8a1e86736d98,af34b614-3b87-4203-b23f-465fd168d5fd,a1c7c8a4-301b-4dd0-84d8-92ec477c0edf,9d3b1cc5-9622-43bb-b3bd-644ef5ae1b9a,7847fe92-ce01-44a2-8c3c-1f7fffecdb3d,74ec5e23-039c-4579-9760-e99f35d79b8c,c0e5e79d-0858-4138-9a7f-c77d342b3735,add927f0-ba7b-40ec-a35a-252a5d85d506,198aa60e-f412-4cee-9ff8-a8de439a441d,62c16a68-a3e7-44db-b218-9fe1aaf0424d,751b1f2d-7813-40b0-b576-7b8a6ad1849e,128107d4-400e-46ad-a1f5-aa19377c724b,0caf2667-d2bb-42e8-b09c-6d6185ef98c6,ca670844-4fe6-457f-959e-949f9595d278,d706d9b5-4e54-4ce7-89bc-75af21fac6d1,7e9a71b0-88a4-4366-bed9-908e24262829,863e4061-ebb0-432d-b87c-f73387e691e1,edd42e85-79f5-4596-823b-42f02a85e4ce,6a7119d9-32b6-4bdf-aa2e-36faf9f380ce,4bbc589e-95ce-4202-832a-7be902780746,526598e1-caf4-4e71-81bb-889a9d8073c5,ca2eb655-9e81-4aa0-af62-a818da132ef2,8ef13e7c-0aba-4c74-8f50-7084140d8815,ed52f310-9e1c-4389-bd86-e19180b099b5,b7932dd6-ae9b-4e7b-98f9-bf0810f5e043,6bbddaf7-40f6-460a-b2cd-ef12f375544c,242baa97-3a09-46ba-bdcb-814d362f6be2,7cc6b759-3c43-4413-ae5d-f66c4b4d534a,e4c751fe-3ab9-4dec-9144-2108380e9a13,ca0e0b6d-8030-48de-9dc2-2eb4a0e76461,0e30fe7c-1316-4702-868d-a64d425785e6,71426b4e-e62f-4fee-a1af-c6b04dbd7304,0ef760a5-049f-4510-a6cb-faa83d720d9c,6523fcf6-1e13-4814-94fe-36c5d7f6b4d5,f4e6590e-1871-416a-894f-3c993bd25134,fc376c37-7e6b-421e-a12d-712b12e847a8,0d0de566-4ed9-43c5-91c4-ec59b57aa71c,1ac64055-caba-4e0c-b64e-ce5db62cb6b2,a24161be-a7a0-40f8-9a33-afbc321cb24a,3d2c30f9-aa0c-4c58-8f3a-f63e736dcd9f"
#!   FME_LINKED_TRANSFORMER_VERSION="1"
#!   FME_NAMES_ENCODING="windows-1252"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_PROCESS_PRESERVE_GROUP_ATTR="No"
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked Always"
#!   HISTORY="October&lt;space&gt;28&lt;comma&gt;&lt;space&gt;2017,Sander&lt;space&gt;Schamin&lt;u00e9&gt;e,Initial&lt;space&gt;creation,March&lt;space&gt;14&lt;comma&gt;&lt;space&gt;2024,Haider&lt;space&gt;Saeed,Added&lt;space&gt;Extra&lt;space&gt;Functionalities"
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2022.0.0.2 (20220518 - Build 22343 - WIN64)"
#!   LAST_SAVE_DATE="2024-03-14T13:52:34"
#!   MARKDOWN_DESCRIPTION="**Transposes attributes so that the values in any selected Column Attribute are transposed into their own individual columns. The corresponding selected Row Attribute(s) will also be transposed in accordance with the selected column and its attributes. Aggregation works by grouping the results into desired Group-By column categories. This transformer also allows you to add a suffix to the end of the newly transposed column names in order to maintain clarity and produce distinction between previously defined data columns.**&#10;&#10;### (Example):&#10;**The table below shows the inputs offered by the transformer:**&#10;&#10;![Inputs](https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Transformer%20Inputs.PNG)&#10;&#10;&#10;**The data structure below shows the data before it is transposed. **&#10;&#10;![Data](https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Data%20before%20transformer%20processing.PNG)&#10;&#10;&#10;**The next image shows the state of data after it has gone through the transformer using the inputs specified in Image 1. This displays the tranposing + aggregation behavior of the transformer.&#10;**&#10;&#10;![TransformerBehavior](https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Data%20after%20transformer%20processing.PNG)&#10;&#10;&#10;&#10;### _Notes_ &#10;- The transformer will not preserve geometry. It only works on tabular data. &#10;- New attributes are created dynamically and should be exposed using an [AttributeExposer](https://www.safe.com/transformers/attribute-exposer/), for example. &#10;- All original attributes will still be exposed on the output feature, but will not have a value, except for the Column Attributes. &#10;- This transformer has been tested on Python 2.7 and 3.4. &#10;"
#!   MARKDOWN_USAGE="**_Columns Attribute (REQUIRED)_**&#10;&#10;- Allows you to choose one column to tranpose their values into individual columns. The order in which features arrive, determines the order in which new attributes/columns are created, but since these attributes are not sequenced, this can&apos;t be guaranteed.&#10;&#10;####**_Row Attribute(s) (REQUIRED)_**&#10;&#10;- Allows you to choose one/multiple columns so that their values can be transposed under the new column headers after transposition. Select at least 1 attribute whose values will be used to effectively transform the attribute values of the chosen column attribute set above. It is also important to know that the order in which you specify the row attributes determines the feature output order.&#10;&#10;**_Group By Attribute(s) (OPTIONAL)_**&#10;&#10;- Allows you to specify one/more columns that need to be aggregated. &#10;&#10;**_Column Name Suffix (OPTIONAL)_**&#10;&#10;- Allows you to add a suffix to the end of the newly transposed column names. Leaving it blank preserves the original column names provided.&#10;&#10;![Inputs](https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Transformer%20Inputs.PNG)&#10;&#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="39"
#!   REPLACED_BY=""
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="AggregatorTransposer"
#!   USAGE="&lt;p&gt;&lt;strong&gt;&lt;em&gt;Columns Attribute (REQUIRED)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&#10;&lt;ul&gt;&#10;&lt;li&gt;Allows you to choose one column to tranpose their values into individual columns. The order in which features arrive, determines the order in which new attributes/columns are created, but since these attributes are not sequenced, this can&apos;t be guaranteed.&lt;/li&gt;&#10;&lt;/ul&gt;&#10;&lt;h4&gt;&lt;strong&gt;&lt;em&gt;Row Attribute(s) (REQUIRED)&lt;/em&gt;&lt;/strong&gt;&lt;/h4&gt;&#10;&lt;ul&gt;&#10;&lt;li&gt;Allows you to choose one/multiple columns so that their values can be transposed under the new column headers after transposition. Select at least 1 attribute whose values will be used to effectively transform the attribute values of the chosen column attribute set above. It is also important to know that the order in which you specify the row attributes determines the feature output order.&lt;/li&gt;&#10;&lt;/ul&gt;&#10;&lt;p&gt;&lt;strong&gt;&lt;em&gt;Group By Attribute(s) (OPTIONAL)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&#10;&lt;ul&gt;&#10;&lt;li&gt;Allows you to specify one/more columns that need to be aggregated. &lt;/li&gt;&#10;&lt;/ul&gt;&#10;&lt;p&gt;&lt;strong&gt;&lt;em&gt;Column Name Suffix (OPTIONAL)&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&#10;&lt;ul&gt;&#10;&lt;li&gt;Allows you to add a suffix to the end of the newly transposed column names. Leaving it blank preserves the original column names provided.&lt;/li&gt;&#10;&lt;/ul&gt;&#10;&lt;p&gt;&lt;img alt=&quot;Inputs&quot; src=&quot;https://raw.githubusercontent.com/msa280/FME/main/AggregatorTransposer/Images/Transformer%20Inputs.PNG&quot; /&gt;&lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-2282.63 176.632"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="69"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI ATTR COL_ATTR &quot;&quot; Column Attribute"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI ORDEREDLIST_OR_ATTR ROW_ATTR ATTRLIST Row Attribute(s)"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI ORDEREDLIST GROUP_BY ATTRLIST Group By Attribute(s)"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI OPTIONAL STRING_OR_ATTR COL_SUFFIX Column Name Suffix (Optional)"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <USER_PARAMETERS
#!   FORM="eyJwYXJhbWV0ZXJzIjpbeyJjaG9pY2VTZXR0aW5ncyI6eyJjaG9pY2VTZXQiOiJhdHRyaWJ1dGVOYW1lcyJ9LCJkZWZhdWx0VmFsdWUiOiIiLCJkZXByZWNhdGVkRmxhZ3MiOlsibm9uZSJdLCJoaWRkZW4iOmZhbHNlLCJuYW1lIjoiQ09MX0FUVFIiLCJwcm9tcHQiOiJDb2x1bW4gQXR0cmlidXRlIiwicmVxdWlyZWQiOnRydWUsInR5cGUiOiJkcm9wZG93biIsInZhbHVlVHlwZSI6InN0cmluZyJ9LHsiYWxsb3dPcmRlcmluZyI6dHJ1ZSwiY2hvaWNlU2V0dGluZ3MiOnsiY2hvaWNlU2V0IjoiYXR0cmlidXRlTmFtZXMifSwiZGVmYXVsdFZhbHVlIjoiIiwiZGVwcmVjYXRlZEZsYWdzIjpbIm5vbmUiXSwiaGlkZGVuIjpmYWxzZSwibmFtZSI6IlJPV19BVFRSIiwicHJvbXB0IjoiUm93IEF0dHJpYnV0ZShzKSIsInJlcXVpcmVkIjp0cnVlLCJzdXBwb3J0ZWRWYWx1ZVR5cGVzIjpbImV4cHJlc3Npb24iLCJnbG9iYWxQYXJhbWV0ZXIiXSwidHlwZSI6Imxpc3Rib3giLCJ2YWx1ZVR5cGUiOiJzdHJpbmdFbmNvZGVkUGFydHMifSx7ImFsbG93T3JkZXJpbmciOnRydWUsImNob2ljZVNldHRpbmdzIjp7ImNob2ljZVNldCI6ImF0dHJpYnV0ZU5hbWVzIn0sImRlZmF1bHRWYWx1ZSI6IiIsImRlcHJlY2F0ZWRGbGFncyI6WyJub25lIl0sImhpZGRlbiI6ZmFsc2UsIm5hbWUiOiJHUk9VUF9CWSIsInByb21wdCI6Ikdyb3VwIEJ5IEF0dHJpYnV0ZShzKSIsInJlcXVpcmVkIjp0cnVlLCJzdXBwb3J0ZWRWYWx1ZVR5cGVzIjpbImdsb2JhbFBhcmFtZXRlciJdLCJ0eXBlIjoibGlzdGJveCIsInZhbHVlVHlwZSI6InN0cmluZ0VuY29kZWRQYXJ0cyJ9LHsiZGVmYXVsdFZhbHVlIjoiIiwiaGlkZGVuIjpmYWxzZSwibmFtZSI6IkNPTF9TVUZGSVgiLCJwcm9tcHQiOiJDb2x1bW4gTmFtZSBTdWZmaXggKE9wdGlvbmFsKSIsInJlcXVpcmVkIjpmYWxzZSwic2hvd0VkaXRCdXR0b24iOmZhbHNlLCJzdXBwb3J0ZWRWYWx1ZVR5cGVzIjpbImV4cHJlc3Npb24iLCJnbG9iYWxQYXJhbWV0ZXIiXSwidHlwZSI6InRleHQiLCJ2YWx1ZVR5cGUiOiJzdHJpbmcifV19"
#! >
#! <PARAMETER_INFO>
#!     <INFO NAME="COL_ATTR" 
#!   DEFAULT_VALUE=""
#!   SCOPE="STAND_ALONE"
#!   GENERATED_GUI_LINE="true"
#!   GUI_LINE="GUI ATTR COL_ATTR &quot;&quot; Column Attribute"
#! />
#!     <INFO NAME="ROW_ATTR" 
#!   DEFAULT_VALUE=""
#!   SCOPE="STAND_ALONE"
#!   GENERATED_GUI_LINE="true"
#!   GUI_LINE="GUI ORDEREDLIST_OR_ATTR ROW_ATTR ATTRLIST Row Attribute(s)"
#! />
#!     <INFO NAME="GROUP_BY" 
#!   DEFAULT_VALUE=""
#!   SCOPE="STAND_ALONE"
#!   GENERATED_GUI_LINE="true"
#!   GUI_LINE="GUI ORDEREDLIST GROUP_BY ATTRLIST Group By Attribute(s)"
#! />
#!     <INFO NAME="COL_SUFFIX" 
#!   DEFAULT_VALUE=""
#!   SCOPE="STAND_ALONE"
#!   GENERATED_GUI_LINE="true"
#!   GUI_LINE="GUI OPTIONAL STRING_OR_ATTR COL_SUFFIX Column Name Suffix (Optional)"
#! />
#! </PARAMETER_INFO>
#! </USER_PARAMETERS>
#! <COMMENTS>
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="-697.66935895016991 -864.96401178292479"
#!   BOUNDING_RECT="-697.66935895016991 -864.96401178292479 430 71"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22343"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="__COL_ATTR" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="__ROW_ATTR" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="__GROUP_BY" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="__COL_SUFFIX" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="__COL_ATTR $(COL_ATTR) __ROW_ATTR $(ROW_ATTR) __GROUP_BY $(GROUP_BY) __COL_SUFFIX $(COL_SUFFIX)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="6"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="-46.54544171576714 -861.00827602303559"
#!   BOUNDING_RECT="-46.54544171576714 -861.00827602303559 430 71"
#!   ORDER="500000000000004"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22343"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="__COL_ATTR" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="__ROW_ATTR" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="__GROUP_BY" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="__COL_SUFFIX" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE="$(GROUP_BY)"/>
#!     <XFORM_PARM PARM_NAME="GROUP_BY_MODE" PARM_VALUE="Yes"/>
#!     <XFORM_PARM PARM_NAME="GROUP_PROCESSING_GROUP" PARM_VALUE="YES"/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="#&lt;space&gt;Custom&lt;space&gt;Aggregator&lt;space&gt;+&lt;space&gt;Transposer&lt;lf&gt;#&lt;space&gt;Edited&lt;space&gt;By&lt;space&gt;Haider&lt;space&gt;S.&lt;space&gt;-&lt;space&gt;8&lt;solidus&gt;03&lt;solidus&gt;2024&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;fme&lt;lf&gt;import&lt;space&gt;fmeobjects&lt;lf&gt;import&lt;space&gt;six&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Global&lt;space&gt;constants&lt;lf&gt;NAMELESS_COL_PREFIX&lt;space&gt;=&lt;space&gt;&lt;quote&gt;Untitled&lt;quote&gt;&lt;lf&gt;COLUMN_ATTRIBUTE&lt;space&gt;=&lt;space&gt;&lt;quote&gt;__COL_ATTR&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;NullAttribute&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Null&lt;space&gt;type&lt;space&gt;class&lt;space&gt;for&lt;space&gt;FME.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;fme_type&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.fme_type&lt;space&gt;=&lt;space&gt;fme_type&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__str__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;class&lt;space&gt;ErrorHandler&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Simple&lt;space&gt;error&lt;space&gt;handler.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.log&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;throw&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;error&lt;comma&gt;&lt;space&gt;user_error&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Log&lt;space&gt;Python&lt;space&gt;error&lt;space&gt;and&lt;space&gt;throw&lt;space&gt;FME&lt;space&gt;error.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.log.logMessageString&lt;openparen&gt;error&lt;comma&gt;&lt;space&gt;fmeobjects.FME_ERROR&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;fmeobjects.FMEException&lt;openparen&gt;user_error&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor&lt;openparen&gt;object&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Initialize&lt;space&gt;and&lt;space&gt;set&lt;space&gt;defaults.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Set&lt;space&gt;up&lt;space&gt;an&lt;space&gt;error&lt;space&gt;handler&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.error_h&lt;space&gt;=&lt;space&gt;ErrorHandler&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Set-up&lt;space&gt;FME&lt;space&gt;Session&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.session&lt;space&gt;=&lt;space&gt;fmeobjects.FMESession&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.row_headers&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pivot_column&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Desired&lt;space&gt;row&lt;solidus&gt;record&lt;space&gt;values&lt;space&gt;are&lt;space&gt;reset&lt;space&gt;to&lt;space&gt;empty&lt;space&gt;with&lt;space&gt;each&lt;space&gt;new&lt;space&gt;feature&lt;space&gt;that&lt;space&gt;is&lt;space&gt;read.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.records&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;This&lt;space&gt;is&lt;space&gt;a&lt;space&gt;helper&lt;space&gt;function&lt;space&gt;used&lt;space&gt;to&lt;space&gt;process&lt;space&gt;the&lt;space&gt;column&lt;space&gt;name.&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;prepare_column&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;column_attr&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Make&lt;space&gt;sure&lt;space&gt;that&lt;space&gt;the&lt;space&gt;column&lt;space&gt;has&lt;space&gt;a&lt;space&gt;correct&lt;space&gt;name.&lt;space&gt;Also&lt;space&gt;initializes&lt;space&gt;a&lt;space&gt;new&lt;space&gt;column&lt;space&gt;in&lt;space&gt;the&lt;space&gt;records&lt;space&gt;dictionary.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;name&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;column_attr&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;openparen&gt;not&lt;space&gt;name&lt;space&gt;and&lt;space&gt;name&lt;space&gt;!=&lt;space&gt;0&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;name&lt;space&gt;=&lt;space&gt;NAMELESS_COL_PREFIX&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Format&lt;space&gt;non-text&lt;space&gt;types&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;openparen&gt;not&lt;space&gt;&lt;openparen&gt;isinstance&lt;openparen&gt;name&lt;comma&gt;&lt;space&gt;&lt;openparen&gt;str&lt;comma&gt;&lt;space&gt;six.text_type&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;openparen&gt;&lt;openparen&gt;isinstance&lt;openparen&gt;name&lt;comma&gt;&lt;space&gt;float&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;and&lt;space&gt;&lt;openparen&gt;int&lt;openparen&gt;name&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;name&lt;closeparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;if&lt;space&gt;name&lt;space&gt;is&lt;space&gt;float&lt;space&gt;and&lt;space&gt;a&lt;space&gt;number&lt;comma&gt;&lt;space&gt;convert&lt;space&gt;it&lt;space&gt;into&lt;space&gt;that&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;name&lt;space&gt;=&lt;space&gt;int&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Add&lt;space&gt;suffix&lt;space&gt;to&lt;space&gt;the&lt;space&gt;name&lt;space&gt;after&lt;space&gt;formattig&lt;space&gt;it.&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;name&lt;space&gt;=&lt;space&gt;format&lt;openparen&gt;name&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;__COL_SUFFIX&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Add&lt;space&gt;the&lt;space&gt;column&lt;space&gt;name&lt;space&gt;to&lt;space&gt;dictionary&lt;space&gt;records&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.records&lt;openbracket&gt;name&lt;closebracket&gt;&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;name&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Takes&lt;space&gt;the&lt;space&gt;input&lt;space&gt;feature&lt;space&gt;per&lt;space&gt;row&lt;space&gt;and&lt;space&gt;processes&lt;space&gt;it.&lt;space&gt;This&lt;space&gt;is&lt;space&gt;also&lt;space&gt;a&lt;space&gt;necessary&lt;space&gt;function.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Process&lt;space&gt;each&lt;space&gt;feature&lt;space&gt;and&lt;space&gt;collect&lt;space&gt;columns&lt;space&gt;and&lt;space&gt;rows.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Per&lt;space&gt;feature&lt;space&gt;so&lt;space&gt;have&lt;space&gt;to&lt;space&gt;reset&lt;space&gt;the&lt;space&gt;pivot_col&lt;space&gt;and&lt;space&gt;row_headers&lt;space&gt;again&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pivot_column&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;COLUMN_ATTRIBUTE&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;all&lt;space&gt;the&lt;space&gt;values&lt;space&gt;in&lt;space&gt;the&lt;space&gt;row&lt;space&gt;and&lt;space&gt;split&lt;space&gt;them.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;row_headers&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;__ROW_ATTR&lt;apos&gt;&lt;closeparen&gt;.split&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.row_headers&lt;space&gt;=&lt;space&gt;list&lt;openparen&gt;map&lt;openparen&gt;self.session.decodeFromFMEParsableText&lt;comma&gt;&lt;space&gt;row_headers&lt;closeparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Send&lt;space&gt;the&lt;space&gt;pivot_col&lt;space&gt;to&lt;space&gt;extract&lt;space&gt;column_name&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_name&lt;space&gt;=&lt;space&gt;self.prepare_column&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;self.pivot_column&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;attr&lt;space&gt;in&lt;space&gt;self.row_headers:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;is_null&lt;comma&gt;&lt;space&gt;missing&lt;comma&gt;&lt;space&gt;fme_type&lt;space&gt;=&lt;space&gt;feature.getAttributeNullMissingAndType&lt;openparen&gt;attr&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Check&lt;space&gt;if&lt;space&gt;attribute&lt;space&gt;is&lt;space&gt;null&lt;space&gt;and&lt;space&gt;give&lt;space&gt;it&lt;space&gt;a&lt;space&gt;null&lt;space&gt;type&lt;space&gt;value&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;openparen&gt;is_null&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_value&lt;space&gt;=&lt;space&gt;NullAttribute&lt;openparen&gt;fme_type&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Otherwise&lt;comma&gt;&lt;space&gt;get&lt;space&gt;the&lt;space&gt;value&lt;space&gt;of&lt;space&gt;the&lt;space&gt;row&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;else:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_value&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;attr&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Add&lt;space&gt;the&lt;space&gt;value&lt;space&gt;to&lt;space&gt;the&lt;space&gt;desired&lt;space&gt;attribute&lt;space&gt;dictionary&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.records&lt;openbracket&gt;column_name&lt;closebracket&gt;&lt;space&gt;=&lt;space&gt;column_value&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;err:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.error_h.throw&lt;openparen&gt;err&lt;comma&gt;&lt;space&gt;&lt;quote&gt;AttributeTransposer&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;process&lt;space&gt;features.&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;del&lt;space&gt;self&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;The&lt;space&gt;process_group&lt;space&gt;is&lt;space&gt;a&lt;space&gt;necessary&lt;space&gt;function&lt;space&gt;which&lt;space&gt;is&lt;space&gt;required&lt;space&gt;when&lt;space&gt;Group&lt;space&gt;Processing&lt;space&gt;is&lt;space&gt;ticked.&lt;space&gt;It&lt;space&gt;manages&lt;space&gt;what&lt;space&gt;needs&lt;space&gt;to&lt;space&gt;be&lt;space&gt;done&lt;space&gt;after&lt;space&gt;a&lt;space&gt;certain&lt;space&gt;group&lt;space&gt;has&lt;space&gt;been&lt;space&gt;processed.&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;process_group&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#print&lt;openparen&gt;&lt;quote&gt;Processing&lt;space&gt;Group&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Get&lt;space&gt;all&lt;space&gt;the&lt;space&gt;new&lt;space&gt;column&lt;space&gt;names&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;columns&lt;space&gt;=&lt;space&gt;self.records.keys&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;a&lt;space&gt;new&lt;space&gt;FME&lt;space&gt;Feature&lt;space&gt;Object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;attr_name&lt;space&gt;in&lt;space&gt;columns:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Checking&lt;space&gt;if&lt;space&gt;the&lt;space&gt;column&lt;space&gt;value&lt;space&gt;is&lt;space&gt;empty&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;&lt;openparen&gt;self.records&lt;openbracket&gt;attr_name&lt;closebracket&gt;&lt;space&gt;!=&lt;space&gt;None&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;value&lt;space&gt;is&lt;space&gt;not&lt;space&gt;empty&lt;comma&gt;&lt;space&gt;get&lt;space&gt;the&lt;space&gt;value&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;attr_value&lt;space&gt;=&lt;space&gt;self.records&lt;openbracket&gt;attr_name&lt;closebracket&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;else:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;value&lt;space&gt;is&lt;space&gt;empty&lt;comma&gt;&lt;space&gt;set&lt;space&gt;it&lt;space&gt;to&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;attr_value&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;isinstance&lt;openparen&gt;attr_value&lt;comma&gt;&lt;space&gt;NullAttribute&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Set&lt;space&gt;feature&lt;space&gt;to&lt;space&gt;a&lt;space&gt;null&lt;space&gt;type&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttributeNullWithType&lt;openparen&gt;attr_name&lt;comma&gt;&lt;space&gt;attr_value.fme_type&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;else:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Add&lt;space&gt;the&lt;space&gt;col&lt;space&gt;name&lt;space&gt;and&lt;space&gt;corresponding&lt;space&gt;value&lt;space&gt;to&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;object&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.setAttribute&lt;openparen&gt;attr_name&lt;comma&gt;&lt;space&gt;attr_value&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Output&lt;space&gt;the&lt;space&gt;row&lt;space&gt;with&lt;space&gt;new&lt;space&gt;columns&lt;space&gt;and&lt;space&gt;value&lt;space&gt;grouped&lt;space&gt;by&lt;space&gt;the&lt;space&gt;chosen&lt;space&gt;attribute&lt;openparen&gt;s&lt;closeparen&gt;&lt;space&gt;before&lt;space&gt;next&lt;space&gt;group&lt;space&gt;is&lt;space&gt;processed&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Initialise&lt;space&gt;fresh&lt;space&gt;variables&lt;space&gt;with&lt;space&gt;empty&lt;space&gt;values&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;err:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.error_h.throw&lt;openparen&gt;err&lt;comma&gt;&lt;space&gt;&lt;quote&gt;AttributeTransposer&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;output&lt;space&gt;transposed&lt;space&gt;features.&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;del&lt;space&gt;self&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;This&lt;space&gt;is&lt;space&gt;a&lt;space&gt;close&lt;space&gt;function&lt;space&gt;which&lt;space&gt;is&lt;space&gt;also&lt;space&gt;necessary.&lt;space&gt;It&lt;space&gt;tells&lt;space&gt;Python&lt;space&gt;what&lt;space&gt;to&lt;space&gt;do&lt;space&gt;when&lt;space&gt;all&lt;space&gt;the&lt;space&gt;attributes&lt;space&gt;have&lt;space&gt;been&lt;space&gt;read.&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;space&gt;Create&lt;space&gt;new&lt;space&gt;features&lt;space&gt;for&lt;space&gt;each&lt;space&gt;row&lt;space&gt;in&lt;space&gt;records&lt;space&gt;dict.&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;err:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.error_h.throw&lt;openparen&gt;err&lt;comma&gt;&lt;space&gt;&lt;quote&gt;AttributeTransposer&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;output&lt;space&gt;transposed&lt;space&gt;features.&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;del&lt;space&gt;self&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="PythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="AttributeRemover"
#!   VERSION="1"
#!   POSITION="573.10839991773867 -861.00827602303559"
#!   BOUNDING_RECT="573.10839991773867 -861.00827602303559 430 71"
#!   ORDER="500000000000005"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="22343"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="REMOVE_ATTRS" PARM_VALUE="__COL_ATTR,__COL_SUFFIX,__GROUP_BY,__ROW_ATTR"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="AttributeRemover"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="5"
#!   NAME="Input"
#!   POSITION="-1367.6609614509098 -864.96401178292479"
#!   BOUNDING_RECT="-1367.6609614509098 -864.96401178292479 431 71"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="7"
#!   NAME="Output"
#!   POSITION="1244.3754939590215 -864.96401178292479"
#!   BOUNDING_RECT="1244.3754939590215 -864.96401178292479 431 71"
#!   COLLAPSED="false"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="11"
#!   SOURCE_NODE="5"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="9"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="6"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="10"
#!   SOURCE_NODE="6"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="7"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   COLOUR="0,0,0,1"
#!   PEN_WIDTH="4"
#!   PEN_STYLE="1"
#!   LINK_STYLE_NAME="&lt;Default&gt;"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>

FME_PYTHON_VERSION 39
# ============================================================================
DEFAULT_MACRO $(AggregatorTransposer_WORKSPACE_NAME)_COL_ATTR 

DEFAULT_MACRO $(AggregatorTransposer_WORKSPACE_NAME)_ROW_ATTR 

DEFAULT_MACRO $(AggregatorTransposer_WORKSPACE_NAME)_GROUP_BY 

DEFAULT_MACRO $(AggregatorTransposer_WORKSPACE_NAME)_COL_SUFFIX 

# ============================================================================
#! START_HEADER
#! END_HEADER

DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO AggregatorTransposer_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(AggregatorTransposer_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(AggregatorTransposer_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(AggregatorTransposer_WORKSPACE_NAME)_Input1710377554 Input Splitter"   INPUT FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------
Tcl2 proc $(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"__COL_ATTR {$($(AggregatorTransposer_WORKSPACE_NAME)_COL_ATTR$encode)} __ROW_ATTR {$($(AggregatorTransposer_WORKSPACE_NAME)_ROW_ATTR)} __GROUP_BY {$($(AggregatorTransposer_WORKSPACE_NAME)_GROUP_BY)} __COL_SUFFIX {$($(AggregatorTransposer_WORKSPACE_NAME)_COL_SUFFIX$encode)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF {*} TeeFactory    FACTORY_NAME { $(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher }    INPUT  FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_Input"    OUTPUT { FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher_doFetch)          }
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF {*} PythonFactory    FACTORY_NAME { $(AggregatorTransposer_WORKSPACE_NAME)_PythonCaller }    GROUP_BY { $($(AggregatorTransposer_WORKSPACE_NAME)_GROUP_BY) }    FLUSH_WHEN_GROUPS_CHANGE { Yes }    INPUT  FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    SYMBOL_NAME { FeatureProcessor }    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE { #<space>Custom<space>Aggregator<space>+<space>Transposer<lf>#<space>Edited<space>By<space>Haider<space>S.<space>-<space>8<solidus>03<solidus>2024<lf><lf>import<space>fme<lf>import<space>fmeobjects<lf>import<space>six<lf><lf>#<space>Global<space>constants<lf>NAMELESS_COL_PREFIX<space>=<space><quote>Untitled<quote><lf>COLUMN_ATTRIBUTE<space>=<space><quote>__COL_ATTR<quote><lf><lf><lf>class<space>NullAttribute<openparen>object<closeparen>:<lf><space><space><space><space><quote><quote><quote><space>Null<space>type<space>class<space>for<space>FME.<space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>fme_type<closeparen>:<lf><space><space><space><space><space><space><space><space>self.fme_type<space>=<space>fme_type<lf><space><space><space><space>def<space>__str__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space><apos><apos><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf>class<space>ErrorHandler<openparen><closeparen>:<lf><space><space><space><space><quote><quote><quote><space>Simple<space>error<space>handler.<space><quote><quote><quote><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>self.log<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space>def<space>throw<openparen>self<comma><space>error<comma><space>user_error<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><space>Log<space>Python<space>error<space>and<space>throw<space>FME<space>error.<space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>self.log.logMessageString<openparen>error<comma><space>fmeobjects.FME_ERROR<closeparen><lf><space><space><space><space><space><space><space><space>raise<space>fmeobjects.FMEException<openparen>user_error<closeparen><lf><lf><lf>class<space>FeatureProcessor<openparen>object<closeparen>:<lf><space><space><space><space><lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><space>Initialize<space>and<space>set<space>defaults.<space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>#<space>Set<space>up<space>an<space>error<space>handler<lf><space><space><space><space><space><space><space><space>self.error_h<space>=<space>ErrorHandler<openparen><closeparen><lf><space><space><space><space><space><space><space><space>#<space>Set-up<space>FME<space>Session<lf><space><space><space><space><space><space><space><space>self.session<space>=<space>fmeobjects.FMESession<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.row_headers<space>=<space>None<lf><space><space><space><space><space><space><space><space>self.pivot_column<space>=<space>None<lf><space><space><space><space><space><space><space><space>#<space>Desired<space>row<solidus>record<space>values<space>are<space>reset<space>to<space>empty<space>with<space>each<space>new<space>feature<space>that<space>is<space>read.<lf><space><space><space><space><space><space><space><space>self.records<space>=<space><opencurly><closecurly><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><lf><space><space><space><space><lf><space><space><space><space>#<space>This<space>is<space>a<space>helper<space>function<space>used<space>to<space>process<space>the<space>column<space>name.<space><space><space><lf><space><space><space><space>def<space>prepare_column<openparen>self<comma><space>feature<comma><space>column_attr<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><space>Make<space>sure<space>that<space>the<space>column<space>has<space>a<space>correct<space>name.<space>Also<space>initializes<space>a<space>new<space>column<space>in<space>the<space>records<space>dictionary.<space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>name<space>=<space>feature.getAttribute<openparen>column_attr<closeparen><lf><space><space><space><space><space><space><space><space>if<space><openparen>not<space>name<space>and<space>name<space>!=<space>0<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>name<space>=<space>NAMELESS_COL_PREFIX<lf><space><space><space><space><space><space><space><space>#<space>Format<space>non-text<space>types<lf><space><space><space><space><space><space><space><space>if<space><openparen>not<space><openparen>isinstance<openparen>name<comma><space><openparen>str<comma><space>six.text_type<closeparen><closeparen><closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space><openparen><openparen>isinstance<openparen>name<comma><space>float<closeparen><closeparen><space>and<space><openparen>int<openparen>name<closeparen><space>==<space>name<closeparen><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>if<space>name<space>is<space>float<space>and<space>a<space>number<comma><space>convert<space>it<space>into<space>that<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>name<space>=<space>int<openparen>name<closeparen><lf><space><space><space><space><space><space><space><space>#<space>Add<space>suffix<space>to<space>the<space>name<space>after<space>formattig<space>it.<space><space><lf><space><space><space><space><space><space><space><space>name<space>=<space>format<openparen>name<closeparen><space>+<space>feature.getAttribute<openparen><apos>__COL_SUFFIX<apos><closeparen><lf><space><space><space><space><space><space><space><space>#<space>Add<space>the<space>column<space>name<space>to<space>dictionary<space>records<lf><space><space><space><space><space><space><space><space>self.records<openbracket>name<closebracket><space>=<space>None<lf><space><space><space><space><space><space><space><space>return<space>name<lf><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><lf><space><space><space><space>#<space>Takes<space>the<space>input<space>feature<space>per<space>row<space>and<space>processes<space>it.<space>This<space>is<space>also<space>a<space>necessary<space>function.<lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><space>Process<space>each<space>feature<space>and<space>collect<space>columns<space>and<space>rows.<space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Per<space>feature<space>so<space>have<space>to<space>reset<space>the<space>pivot_col<space>and<space>row_headers<space>again<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pivot_column<space>=<space>feature.getAttribute<openparen>COLUMN_ATTRIBUTE<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Get<space>all<space>the<space>values<space>in<space>the<space>row<space>and<space>split<space>them.<lf><space><space><space><space><space><space><space><space><space><space><space><space>row_headers<space>=<space>feature.getAttribute<openparen><apos>__ROW_ATTR<apos><closeparen>.split<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.row_headers<space>=<space>list<openparen>map<openparen>self.session.decodeFromFMEParsableText<comma><space>row_headers<closeparen><closeparen><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Send<space>the<space>pivot_col<space>to<space>extract<space>column_name<lf><space><space><space><space><space><space><space><space><space><space><space><space>column_name<space>=<space>self.prepare_column<openparen>feature<comma><space>self.pivot_column<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>for<space>attr<space>in<space>self.row_headers:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>is_null<comma><space>missing<comma><space>fme_type<space>=<space>feature.getAttributeNullMissingAndType<openparen>attr<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Check<space>if<space>attribute<space>is<space>null<space>and<space>give<space>it<space>a<space>null<space>type<space>value<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space><openparen>is_null<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_value<space>=<space>NullAttribute<openparen>fme_type<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Otherwise<comma><space>get<space>the<space>value<space>of<space>the<space>row<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>else:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_value<space>=<space>feature.getAttribute<openparen>attr<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Add<space>the<space>value<space>to<space>the<space>desired<space>attribute<space>dictionary<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.records<openbracket>column_name<closebracket><space>=<space>column_value<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>err:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.error_h.throw<openparen>err<comma><space><quote>AttributeTransposer<space>failed<space>to<space>process<space>features.<quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>del<space>self<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space>#<space>The<space>process_group<space>is<space>a<space>necessary<space>function<space>which<space>is<space>required<space>when<space>Group<space>Processing<space>is<space>ticked.<space>It<space>manages<space>what<space>needs<space>to<space>be<space>done<space>after<space>a<space>certain<space>group<space>has<space>been<space>processed.<space><space><space><space><lf><space><space><space><space>def<space>process_group<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>#print<openparen><quote>Processing<space>Group<quote><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Get<space>all<space>the<space>new<space>column<space>names<lf><space><space><space><space><space><space><space><space><space><space><space><space>columns<space>=<space>self.records.keys<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>a<space>new<space>FME<space>Feature<space>Object<lf><space><space><space><space><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>for<space>attr_name<space>in<space>columns:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Checking<space>if<space>the<space>column<space>value<space>is<space>empty<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space><openparen>self.records<openbracket>attr_name<closebracket><space>!=<space>None<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>value<space>is<space>not<space>empty<comma><space>get<space>the<space>value<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>attr_value<space>=<space>self.records<openbracket>attr_name<closebracket><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>else:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>value<space>is<space>empty<comma><space>set<space>it<space>to<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>attr_value<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>isinstance<openparen>attr_value<comma><space>NullAttribute<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Set<space>feature<space>to<space>a<space>null<space>type<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>feature.setAttributeNullWithType<openparen>attr_name<comma><space>attr_value.fme_type<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>else:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Add<space>the<space>col<space>name<space>and<space>corresponding<space>value<space>to<space>the<space>feature<space>object<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>feature.setAttribute<openparen>attr_name<comma><space>attr_value<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Output<space>the<space>row<space>with<space>new<space>columns<space>and<space>value<space>grouped<space>by<space>the<space>chosen<space>attribute<openparen>s<closeparen><space>before<space>next<space>group<space>is<space>processed<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Initialise<space>fresh<space>variables<space>with<space>empty<space>values<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><lf><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>err:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.error_h.throw<openparen>err<comma><space><quote>AttributeTransposer<space>failed<space>to<space>output<space>transposed<space>features.<quote><closeparen><lf><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space>del<space>self<lf><space><space><space><space><space><lf><space><space><space><space><space><lf><space><space><space><space><space><lf><space><space><space><space>#<space>This<space>is<space>a<space>close<space>function<space>which<space>is<space>also<space>necessary.<space>It<space>tells<space>Python<space>what<space>to<space>do<space>when<space>all<space>the<space>attributes<space>have<space>been<space>read.<space><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote><space>Create<space>new<space>features<space>for<space>each<space>row<space>in<space>records<space>dict.<space><quote><quote><quote><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>pass<lf><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>err:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.error_h.throw<openparen>err<comma><space><quote>AttributeTransposer<space>failed<space>to<space>output<space>transposed<space>features.<quote><closeparen><lf><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space>del<space>self<lf> }    OUTPUT { PYOUTPUT FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_PythonCaller_OUTPUT"         }
# -------------------------------------------------------------------------
# Build the List removal function and regular expression if there was any list attributes to be removed.
# If not, then we will not have any extra list removal call to @RemoveAttributes, which speeds the
# normal, non-list removal especially when in Bulk Mode.  Note that this computation of the regular expressions is done
# once during mapping file parse time.
INCLUDE [    set listAttributeRemoveRegexps {};    set anyList {no};    foreach attr [split ""] {       set attr [FME_DecodeText $attr];       set attr [regsub "{}$" $attr "{}.*"];       set attr [regsub -all "{}" $attr "\\{\[0-9\]+\\}"];       append listAttributeRemoveRegexps ",^$attr$";       set anyList {yes};    };    if { ${anyList} == {no} } {        puts {MACRO $(AggregatorTransposer_WORKSPACE_NAME)_AttributeRemover_LIST_FUNC }    } else {        puts "MACRO $(AggregatorTransposer_WORKSPACE_NAME)_AttributeRemover_LIST_FUNC @RemoveAttributes(fme_pcre_match\"$listAttributeRemoveRegexps\")"    }; ]
FACTORY_DEF {*} TeeFactory    FACTORY_NAME { $(AggregatorTransposer_WORKSPACE_NAME)_AttributeRemover }    INPUT  FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_PythonCaller_OUTPUT"    OUTPUT { FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_AttributeRemover_OUTPUT"        @RemoveAttributes(fme_encoded,__COL_ATTR,__COL_SUFFIX,__GROUP_BY,__ROW_ATTR)        $($(AggregatorTransposer_WORKSPACE_NAME)_AttributeRemover_LIST_FUNC)         }
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(AggregatorTransposer_WORKSPACE_NAME)_Output1710377554 Output Collector"   INPUT FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_AttributeRemover_OUTPUT"   OUTPUT FEATURE_TYPE "$(AggregatorTransposer_WORKSPACE_NAME)_Output"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(AggregatorTransposer_WORKSPACE_NAME))}]
